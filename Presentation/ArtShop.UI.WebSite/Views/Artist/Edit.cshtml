@{

    var id = Request.Url.Segments.Last();
    ViewBag.Title = "Editar Artista";
}

<h2>Editar</h2>

<table class="table table-hover">
    <tr>
        <td>FirstName    </td>
        <td><input data-bind="value: Artist.FirstName" />
        <td />
    </tr>
    <tr>
        <td>LastName     </td>
        <td><input data-bind="value: Artist.LastName" />
        <td />
    </tr>
    <tr>
        <td>LifeSpan     </td>
        <td><input data-bind="value: Artist.LifeSpan" />
        <td />
    </tr>
    <tr>
        <td>Country      </td>
        <td><input data-bind="value: Artist.Country" />
        <td />
    </tr>
    <tr>
        <td>Description  </td>
        <td><input data-bind="value: Artist.Description" />
        <td />
    </tr>
    <tr>
        <td>TotalProducts</td>
        <td><input data-bind="value: Artist.TotalProducts" />
        <td />
    </tr>

</table>

<input type="button" value="Guardar" data-bind="click: EditArtist" class="btn btn-primary" />

<div>
    @Html.ActionLink("Volver", "Index")
</div>



@section scripts
{
    <script src="~/Scripts/knockout-3.5.1.js"></script>
    <script src="~/Scripts/knockout.mapping-latest.js"></script>

    <script>

        var AppViewModel = function (data) {

            var self = this;

            Artist = {
                Id: ko.observable(),
                FirstName : ko.observable(),
                LastName : ko.observable(),
                LifeSpan : ko.observable(),
                Country : ko.observable(),
                Description : ko.observable(),
                TotalProducts: ko.observable()
            }

            var idArtista =@id;

            $.getJSON("/Artist/GetArtist/" + idArtista, function (data) {

                ko.mapping.fromJS(data);
                Artist.Id(data.Id)
                Artist.FirstName(data.FirstName);
                Artist.LastName(data.LastName);
                Artist.LifeSpan(data.LifeSpan);
                Artist.Country(data.Country);
                Artist.Description(data.Description);
                Artist.TotalProducts(data.TotalProducts);
            });
            console.log(this.Artist);

            self.EditArtist = function (data) {

                console.log(Artist);
                $.ajax({
                    url: '@Url.Action("EditArtist", "Artist")',
                    type: 'GET',
                    data: Artist,
                    contentType: 'application/json',
                    success: function (result) {

                       window.location = "/Artist";
                    }
                }).fail(
                    function (xhr, textStatus, err) {
                        alert(err);
                    });
            };

        }
        var viewModel = new AppViewModel();
        ko.applyBindings(viewModel);

    </script>

}